**Также известен как:** Introduce Foreign Method

### Проблема
Служебный класс не содержит метода, который вам нужен, при этом у вас нет возможности добавить метод в этот класс.
```
class Report {
  // ...
  void SendReport() 
  {
    DateTime nextDay = previousEnd.AddDays(1);
    // ...
  }
};
```

### Решение
Добавьте метод в клиентский класс и передавайте в него объект служебного класса в качестве аргумента.
```
class Report {
  // ...
  void SendReport() 
  {
    DateTime nextDay = NextDay(previousEnd);
    // ...
  }
  static DateTime NextDay(DateTime date) 
  {
    return date.AddDays(1);
  }
};
```

### Причины рефакторинга
У вас есть код, который использует данные и методы определённого класса. Вы приходите к выводу, что этот код намного лучше будет смотреться и работать внутри нового метода в этом классе. Однако возможность добавить такой метод в класс у вас отсутствует (например, потому что класс находится в сторонней библиотеке).

Данный рефакторинг особенно выгоден в случаях, когда участок кода, который вы хотите перенести в метод, повторяется несколько раз в различных местах программы.

Так как вы передаёте объект служебного класса в параметры нового метода, у вас есть доступ ко всем его полям. Вы можете делать внутри этого метода практически все, что вам может потребоваться, как если бы метод был частью служебного класса.

### Достоинства
Убирает дублирование кода. Если ваш участок кода повторяется в нескольких местах, вы можете заменить их вызовом метода. Это удобнее дублирования даже с учетом того, что внешний метод находится не там, где хотелось бы.

### Недостатки
Причины того, почему метод служебного класса находится в клиентском классе, не всегда очевидны для того специалиста, который будет поддерживать код после вас. Если данный метод может быть использован и в других классах, имеет смысл создать обёртку над служебным классом, и поместить метод туда. То же самое имеет смысл сделать, если таких служебных методов несколько. В этом поможет рефакторинг [введение локального расширения](Введение%20локального%20расширения.md).

### Порядок рефакторинга
1. Создайте новый метод в клиентском классе.
    
2. В этом методе создайте параметр, в который будет передаваться объект служебного класса. Если этот объект может быть получен из клиентского класса, параметр можно не создавать.
    
3. Извлеките волнующие вас участки кода в этот метод и замените их вызовами метода.
    
4. Обязательно оставьте в комментарии к этому методу метку _Foreign method_ и призыв поместить этот метод в служебный класс, если такая возможность появится в дальнейшем. Это облегчит понимание того, почему этот метод находится в данном классе для тех, кто будет поддерживать программный продукт в будущем.

### Родственные рефакторинги
[Введение локального расширения](Введение%20локального%20расширения.md)

### Борется с запахом
[Неполнота библиотечного класса](Неполнота%20библиотечного%20класса.md)